<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String</title><link rel="stylesheet" href="/css/agda-cats.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings</a>
<a id="117" class="Comment">------------------------------------------------------------------------</a>

<a id="191" class="Symbol">{-#</a> <a id="195" class="Keyword">OPTIONS</a> <a id="203" class="Pragma">--cubical-compatible</a> <a id="224" class="Pragma">--safe</a> <a id="231" class="Symbol">#-}</a>

<a id="236" class="Keyword">module</a> <a id="243" href="Data.String.html" class="Module">Data.String</a> <a id="255" class="Keyword">where</a>

<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="284" class="Keyword">using</a> <a id="290" class="Symbol">(</a><a data-type="Agda.Builtin.Bool.Bool" id="291" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a><a id="295" class="Symbol">;</a> <a data-type="Agda.Builtin.Bool.Bool" id="297" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a><a id="302" class="Symbol">;</a> <a id="304" href="Data.Bool.Properties.html#15479" class="Function">T?</a><a id="306" class="Symbol">)</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Data.Char.html" class="Module">Data.Char</a> <a id="330" class="Symbol">as</a> <a id="333" class="Module">Char</a> <a id="338" class="Keyword">using</a> <a id="344" class="Symbol">(</a><a data-type="Set" id="345" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="349" class="Symbol">)</a>
<a id="351" class="Keyword">open</a> <a id="356" class="Keyword">import</a> <a id="363" href="Function.Base.html" class="Module">Function.Base</a>
<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="403" class="Symbol">as</a> <a id="406" class="Module">ℕ</a> <a id="408" class="Keyword">using</a> <a id="414" class="Symbol">(</a><a data-type="Set" id="415" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="416" class="Symbol">;</a> <a id="418" href="Data.Nat.Base.html#2883" class="Primitive Operator">_∸_</a><a id="421" class="Symbol">;</a> <a id="423" href="Data.Nat.Base.html#3291" class="Function Operator">⌊_/2⌋</a><a id="428" class="Symbol">;</a> <a id="430" href="Data.Nat.Base.html#3418" class="Function Operator">⌈_/2⌉</a><a id="435" class="Symbol">)</a>
<a id="437" class="Keyword">import</a> <a id="444" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="464" class="Symbol">as</a> <a id="467" class="Module">ℕₚ</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="497" class="Symbol">as</a> <a id="500" class="Module">List</a> <a id="505" class="Keyword">using</a> <a id="511" class="Symbol">(</a><a data-type="Set a → Set a" id="512" href="Agda.Builtin.List.html#130" class="Datatype">List</a><a id="516" class="Symbol">;</a> <a data-type="A → Agda.Builtin.List.List A → Agda.Builtin.List.List A" id="518" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">_∷_</a><a id="521" class="Symbol">;</a> <a id="523" href="Data.List.Base.html#10392" class="InductiveConstructor">[]</a><a id="525" class="Symbol">;</a> <a id="527" href="Data.List.Base.html#5034" class="Function Operator">[_]</a><a id="530" class="Symbol">)</a>
<a id="532" class="Keyword">open</a> <a id="537" class="Keyword">import</a> <a id="544" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="563" class="Symbol">as</a> <a id="566" class="Module">NE</a> <a id="569" class="Keyword">using</a> <a id="575" class="Symbol">(</a><a id="576" href="Data.List.NonEmpty.Base.html#1088" class="Record">List⁺</a><a id="581" class="Symbol">)</a>
<a id="583" class="Keyword">open</a> <a id="588" class="Keyword">import</a> <a id="595" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="613" href="Data.Nat.Properties.html#6794" class="Function">ℕₚ.≤-totalOrder</a>
<a id="629" class="Keyword">open</a> <a id="634" class="Keyword">import</a> <a id="641" href="Data.List.Relation.Binary.Pointwise.html" class="Module">Data.List.Relation.Binary.Pointwise</a> <a id="677" class="Keyword">using</a> <a id="683" class="Symbol">(</a><a id="684" href="Data.List.Relation.Binary.Pointwise.Base.html#784" class="Datatype">Pointwise</a><a id="693" class="Symbol">)</a>
<a id="695" class="Keyword">open</a> <a id="700" class="Keyword">import</a> <a id="707" href="Data.List.Relation.Binary.Lex.Strict.html" class="Module">Data.List.Relation.Binary.Lex.Strict</a> <a id="744" class="Keyword">using</a> <a id="750" class="Symbol">(</a><a id="751" href="Data.List.Relation.Binary.Lex.Core.html#1508" class="Function">Lex-&lt;</a><a id="756" class="Symbol">;</a> <a id="758" href="Data.List.Relation.Binary.Lex.Core.html#1614" class="Function">Lex-≤</a><a id="763" class="Symbol">)</a>
<a id="765" class="Keyword">open</a> <a id="770" class="Keyword">import</a> <a id="777" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="791" class="Symbol">as</a> <a id="794" class="Module">Vec</a> <a id="798" class="Keyword">using</a> <a id="804" class="Symbol">(</a><a id="805" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a><a id="808" class="Symbol">)</a>
<a id="810" class="Keyword">open</a> <a id="815" class="Keyword">import</a> <a id="822" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="837" class="Symbol">as</a> <a id="840" class="Module">Char</a> <a id="845" class="Keyword">using</a> <a id="851" class="Symbol">(</a><a data-type="Set" id="852" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a><a id="856" class="Symbol">)</a>
<a id="858" class="Keyword">import</a> <a id="865" href="Data.Char.Properties.html" class="Module">Data.Char.Properties</a> <a id="886" class="Symbol">as</a> <a id="889" class="Module">Char</a> <a id="894" class="Keyword">using</a> <a id="900" class="Symbol">(</a><a id="901" href="Data.Char.Properties.html#1531" class="Function Operator">_≟_</a><a id="904" class="Symbol">)</a>
<a id="906" class="Keyword">open</a> <a id="911" class="Keyword">import</a> <a id="918" href="Function.html" class="Module">Function</a>
<a id="927" class="Keyword">open</a> <a id="932" class="Keyword">import</a> <a id="939" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="955" class="Keyword">using</a> <a id="961" class="Symbol">(</a><a id="962" href="Relation.Binary.Core.html#891" class="Function">Rel</a><a id="965" class="Symbol">)</a>
<a id="967" class="Keyword">open</a> <a id="972" class="Keyword">import</a> <a id="979" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="1017" class="Keyword">using</a> <a id="1023" class="Symbol">(</a><a id="1024" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="1027" class="Symbol">;</a> <a id="1029" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="1033" class="Symbol">)</a>
<a id="1035" class="Keyword">open</a> <a id="1040" class="Keyword">import</a> <a id="1047" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="1064" class="Keyword">using</a> <a id="1070" class="Symbol">(</a><a id="1071" href="Relation.Nullary.html#1590" class="Field">does</a><a id="1075" class="Symbol">)</a>
<a id="1077" class="Keyword">open</a> <a id="1082" class="Keyword">import</a> <a id="1089" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="1104" class="Keyword">using</a> <a id="1110" class="Symbol">(</a><a id="1111" href="Relation.Unary.html#1110" class="Function">Pred</a><a id="1115" class="Symbol">;</a> <a id="1117" href="Relation.Unary.html#3545" class="Function">Decidable</a><a id="1126" class="Symbol">)</a>

<a id="1129" class="Keyword">open</a> <a id="1134" class="Keyword">import</a> <a id="1141" href="Data.List.Membership.DecPropositional.html" class="Module">Data.List.Membership.DecPropositional</a> <a id="1179" href="Data.Char.Properties.html#1531" class="Function Operator">Char._≟_</a>



<a id="1191" class="Comment">------------------------------------------------------------------------</a>
<a id="1264" class="Comment">-- Re-export contents of base, and decidability of equality</a>

<a id="1325" class="Keyword">open</a> <a id="1330" class="Keyword">import</a> <a id="1337" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="1354" class="Keyword">public</a>
<a id="1361" class="Keyword">open</a> <a id="1366" class="Keyword">import</a> <a id="1373" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="1396" class="Keyword">using</a> <a id="1402" class="Symbol">(</a><a id="1403" href="Data.String.Properties.html#1604" class="Function Operator">_≈?_</a><a id="1407" class="Symbol">;</a> <a id="1409" href="Data.String.Properties.html#2284" class="Function Operator">_≟_</a><a id="1412" class="Symbol">;</a> <a id="1414" href="Data.String.Properties.html#2570" class="Function Operator">_&lt;?_</a><a id="1418" class="Symbol">;</a> <a id="1420" href="Data.String.Properties.html#4038" class="Function Operator">_==_</a><a id="1424" class="Symbol">)</a> <a id="1426" class="Keyword">public</a>

<a id="1434" class="Comment">------------------------------------------------------------------------</a>
<a id="1507" class="Comment">-- Conversion functions</a>

<a id="toVec"></a><a id="1532" href="Data.String.html#1532" class="Function">toVec</a> <a id="1538" class="Symbol">:</a> <a id="1540" class="Symbol">(</a><a id="1541" href="Data.String.html#1541" class="Bound">s</a> <a id="1543" class="Symbol">:</a> <a data-type="Set" id="1545" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="1551" class="Symbol">)</a> <a id="1553" class="Symbol">→</a> <a id="1555" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a data-type="Set" id="1559" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1564" class="Symbol">(</a><a id="1565" href="Data.String.Base.html#2439" class="Function">length</a> <a id="1572" href="Data.String.html#1541" class="Bound">s</a><a id="1573" class="Symbol">)</a>
<a id="1575" href="Data.String.html#1532" class="Function">toVec</a> <a id="1581" href="Data.String.html#1581" class="Bound">s</a> <a id="1583" class="Symbol">=</a> <a id="1585" href="Data.Vec.Base.html#7549" class="Function">Vec.fromList</a> <a id="1598" class="Symbol">(</a><a id="1599" href="Data.String.Base.html#1502" class="Primitive">toList</a> <a id="1606" href="Data.String.html#1581" class="Bound">s</a><a id="1607" class="Symbol">)</a>

<a id="fromVec"></a><a id="1610" href="Data.String.html#1610" class="Function">fromVec</a> <a id="1618" class="Symbol">:</a> <a id="1620" class="Symbol">∀</a> <a id="1622" class="Symbol">{</a><a id="1623" href="Data.String.html#1623" class="Bound">n</a><a id="1624" class="Symbol">}</a> <a id="1626" class="Symbol">→</a> <a id="1628" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a data-type="Set" id="1632" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1637" href="Data.String.html#1623" class="Bound">n</a> <a id="1639" class="Symbol">→</a> <a data-type="Set" id="1641" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1648" href="Data.String.html#1610" class="Function">fromVec</a> <a id="1656" class="Symbol">=</a> <a id="1658" href="Data.String.Base.html#1535" class="Primitive">fromList</a> <a id="1667" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1669" href="Data.Vec.Base.html#7447" class="Function">Vec.toList</a>


<a id="1682" class="Comment">-- enclose string with parens if it contains a space character</a>
<a id="parensIfSpace"></a><a id="1745" href="Data.String.html#1745" class="Function">parensIfSpace</a> <a id="1759" class="Symbol">:</a> <a data-type="Set" id="1761" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="1768" class="Symbol">→</a> <a data-type="Set" id="1770" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="1777" href="Data.String.html#1745" class="Function">parensIfSpace</a> <a id="1791" href="Data.String.html#1791" class="Bound">s</a> <a id="1793" class="Keyword">with</a> <a id="1798" href="Relation.Nullary.html#1590" class="Field">does</a> <a id="1803" class="Symbol">(</a><a id="1804" class="String">&#39; &#39;</a> <a id="1808" href="Data.List.Membership.DecSetoid.html#826" class="Function Operator">∈?</a> <a id="1811" href="Data.String.Base.html#1502" class="Primitive">toList</a> <a id="1818" href="Data.String.html#1791" class="Bound">s</a><a id="1819" class="Symbol">)</a>
<a id="1821" class="Symbol">...</a> <a id="1825" class="Symbol">|</a> <a data-type="Agda.Builtin.Bool.Bool" id="1827" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>  <a id="1833" class="Symbol">=</a> <a id="1835" href="Data.String.Base.html#2835" class="Function">parens</a> <a id="1842" class="Bound">s</a>
<a id="1844" class="Symbol">...</a> <a id="1848" class="Symbol">|</a> <a data-type="Agda.Builtin.Bool.Bool" id="1850" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a> <a id="1856" class="Symbol">=</a> <a id="1858" class="Bound">s</a>

<a id="1861" class="Comment">------------------------------------------------------------------------</a>
<a id="1934" class="Comment">-- Splitting strings</a>

<a id="wordsBy"></a><a id="1956" href="Data.String.html#1956" class="Function">wordsBy</a> <a id="1964" class="Symbol">:</a> <a id="1966" class="Symbol">∀</a> <a id="1968" class="Symbol">{</a><a id="1969" href="Data.String.html#1969" class="Bound">p</a><a id="1970" class="Symbol">}</a> <a id="1972" class="Symbol">{</a><a id="1973" href="Data.String.html#1973" class="Bound">P</a> <a id="1975" class="Symbol">:</a> <a id="1977" href="Relation.Unary.html#1110" class="Function">Pred</a> <a data-type="Set" id="1982" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="1987" href="Data.String.html#1969" class="Bound">p</a><a id="1988" class="Symbol">}</a> <a id="1990" class="Symbol">→</a> <a id="1992" href="Relation.Unary.html#3545" class="Function">Decidable</a> <a id="2002" href="Data.String.html#1973" class="Bound">P</a> <a id="2004" class="Symbol">→</a> <a data-type="Set" id="2006" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2013" class="Symbol">→</a> <a data-type="Set a → Set a" id="2015" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a data-type="Set" id="2020" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="2027" href="Data.String.html#1956" class="Function">wordsBy</a> <a id="2035" href="Data.String.html#2035" class="Bound">P?</a> <a id="2038" class="Symbol">=</a> <a id="2040" href="Data.List.Base.html#1553" class="Function">List.map</a> <a id="2049" href="Data.String.Base.html#1535" class="Primitive">fromList</a> <a id="2058" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2060" href="Data.List.Base.html#11707" class="Function">List.wordsBy</a> <a id="2073" href="Data.String.html#2035" class="Bound">P?</a> <a id="2076" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2078" href="Data.String.Base.html#1502" class="Primitive">toList</a>

<a id="words"></a><a id="2086" href="Data.String.html#2086" class="Function">words</a> <a id="2092" class="Symbol">:</a> <a data-type="Set" id="2094" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2101" class="Symbol">→</a> <a data-type="Set a → Set a" id="2103" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a data-type="Set" id="2108" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="2115" href="Data.String.html#2086" class="Function">words</a> <a id="2121" class="Symbol">=</a> <a id="2123" href="Data.String.html#1956" class="Function">wordsBy</a> <a id="2131" class="Symbol">(</a><a id="2132" href="Data.Bool.Properties.html#15479" class="Function">T?</a> <a id="2135" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2137" href="Data.Char.Base.html#891" class="Primitive">Char.isSpace</a><a id="2149" class="Symbol">)</a>

<a id="2152" class="Comment">-- `words` ignores contiguous whitespace</a>
<a id="2193" href="Data.String.html#2193" class="Function">_</a> <a id="2195" class="Symbol">:</a> <a id="2197" href="Data.String.html#2086" class="Function">words</a> <a id="2203" class="String">&quot; abc  b   &quot;</a> <a id="2216" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2218" class="String">&quot;abc&quot;</a> <a data-type="A → Agda.Builtin.List.List A → Agda.Builtin.List.List A" id="2224" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2226" class="String">&quot;b&quot;</a> <a data-type="A → Agda.Builtin.List.List A → Agda.Builtin.List.List A" id="2230" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2232" class="InductiveConstructor">[]</a>
<a id="2235" class="Symbol">_</a> <a id="2237" class="Symbol">=</a> <a id="2239" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="linesBy"></a><a id="2245" href="Data.String.html#2245" class="Function">linesBy</a> <a id="2253" class="Symbol">:</a> <a id="2255" class="Symbol">∀</a> <a id="2257" class="Symbol">{</a><a id="2258" href="Data.String.html#2258" class="Bound">p</a><a id="2259" class="Symbol">}</a> <a id="2261" class="Symbol">{</a><a id="2262" href="Data.String.html#2262" class="Bound">P</a> <a id="2264" class="Symbol">:</a> <a id="2266" href="Relation.Unary.html#1110" class="Function">Pred</a> <a data-type="Set" id="2271" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="2276" href="Data.String.html#2258" class="Bound">p</a><a id="2277" class="Symbol">}</a> <a id="2279" class="Symbol">→</a> <a id="2281" href="Relation.Unary.html#3545" class="Function">Decidable</a> <a id="2291" href="Data.String.html#2262" class="Bound">P</a> <a id="2293" class="Symbol">→</a> <a data-type="Set" id="2295" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2302" class="Symbol">→</a> <a data-type="Set a → Set a" id="2304" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a data-type="Set" id="2309" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="2316" href="Data.String.html#2245" class="Function">linesBy</a> <a id="2324" href="Data.String.html#2324" class="Bound">P?</a> <a id="2327" class="Symbol">=</a> <a id="2329" href="Data.List.Base.html#1553" class="Function">List.map</a> <a id="2338" href="Data.String.Base.html#1535" class="Primitive">fromList</a> <a id="2347" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2349" href="Data.List.Base.html#11119" class="Function">List.linesBy</a> <a id="2362" href="Data.String.html#2324" class="Bound">P?</a> <a id="2365" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2367" href="Data.String.Base.html#1502" class="Primitive">toList</a>

<a id="lines"></a><a id="2375" href="Data.String.html#2375" class="Function">lines</a> <a id="2381" class="Symbol">:</a> <a data-type="Set" id="2383" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2390" class="Symbol">→</a> <a data-type="Set a → Set a" id="2392" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a data-type="Set" id="2397" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
<a id="2404" href="Data.String.html#2375" class="Function">lines</a> <a id="2410" class="Symbol">=</a> <a id="2412" href="Data.String.html#2245" class="Function">linesBy</a> <a id="2420" class="Symbol">(</a><a id="2421" class="String">&#39;\n&#39;</a> <a id="2426" href="Data.Char.Properties.html#1531" class="Function Operator">Char.≟_</a><a id="2433" class="Symbol">)</a>

<a id="2436" class="Comment">-- `lines` preserves empty lines</a>
<a id="2469" href="Data.String.html#2469" class="Function">_</a> <a id="2471" class="Symbol">:</a> <a id="2473" href="Data.String.html#2375" class="Function">lines</a> <a id="2479" class="String">&quot;\nabc\n\nb\n\n\n&quot;</a> <a id="2498" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2500" class="String">&quot;&quot;</a> <a data-type="A → Agda.Builtin.List.List A → Agda.Builtin.List.List A" id="2503" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2505" class="String">&quot;abc&quot;</a> <a data-type="A → Agda.Builtin.List.List A → Agda.Builtin.List.List A" id="2511" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2513" class="String">&quot;&quot;</a> <a data-type="A → Agda.Builtin.List.List A → Agda.Builtin.List.List A" id="2516" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2518" class="String">&quot;b&quot;</a> <a data-type="A → Agda.Builtin.List.List A → Agda.Builtin.List.List A" id="2522" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2524" class="String">&quot;&quot;</a> <a data-type="A → Agda.Builtin.List.List A → Agda.Builtin.List.List A" id="2527" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2529" class="String">&quot;&quot;</a> <a data-type="A → Agda.Builtin.List.List A → Agda.Builtin.List.List A" id="2532" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2534" class="InductiveConstructor">[]</a>
<a id="2537" class="Symbol">_</a> <a id="2539" class="Symbol">=</a> <a id="2541" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="2547" class="Comment">------------------------------------------------------------------------</a>
<a id="2620" class="Comment">-- Rectangle</a>

<a id="2634" class="Comment">-- Build a rectangular column by:</a>
<a id="2668" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="2731" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="2799" href="Data.String.html#2799" class="Function">rectangle</a> <a id="2809" class="Symbol">:</a> <a id="2811" class="Symbol">∀</a> <a id="2813" class="Symbol">{</a><a id="2814" href="Data.String.html#2814" class="Bound">n</a><a id="2815" class="Symbol">}</a> <a id="2817" class="Symbol">→</a> <a id="2819" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="2823" class="Symbol">(</a><a data-type="Set" id="2824" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2826" class="Symbol">→</a> <a data-type="Set" id="2828" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2835" class="Symbol">→</a> <a data-type="Set" id="2837" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="2843" class="Symbol">)</a> <a id="2845" href="Data.String.html#2814" class="Bound">n</a> <a id="2847" class="Symbol">→</a>
            <a id="2861" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a data-type="Set" id="2865" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2872" href="Data.String.html#2814" class="Bound">n</a> <a id="2874" class="Symbol">→</a> <a id="2876" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a data-type="Set" id="2880" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2887" href="Data.String.html#2814" class="Bound">n</a>
<a id="2889" href="Data.String.html#2799" class="Function">rectangle</a> <a id="2899" href="Data.String.html#2899" class="Bound">pads</a> <a id="2904" href="Data.String.html#2904" class="Bound">cells</a> <a id="2910" class="Symbol">=</a> <a id="2912" href="Data.Vec.Base.html#3427" class="Function">Vec.zipWith</a> <a id="2924" class="Symbol">(λ</a> <a id="2927" href="Data.String.html#2927" class="Bound">p</a> <a id="2929" href="Data.String.html#2929" class="Bound">c</a> <a id="2931" class="Symbol">→</a> <a id="2933" href="Data.String.html#2927" class="Bound">p</a> <a id="2935" href="Data.String.html#3009" class="Function">width</a> <a id="2941" href="Data.String.html#2929" class="Bound">c</a><a id="2942" class="Symbol">)</a> <a id="2944" href="Data.String.html#2899" class="Bound">pads</a> <a id="2949" href="Data.String.html#2904" class="Bound">cells</a> <a id="2955" class="Keyword">where</a>

  <a id="2964" href="Data.String.html#2964" class="Function">sizes</a> <a id="2970" class="Symbol">=</a> <a id="2972" href="Data.List.Base.html#1553" class="Function">List.map</a> <a id="2981" href="Data.String.Base.html#2439" class="Function">length</a> <a id="2988" class="Symbol">(</a><a id="2989" href="Data.Vec.Base.html#7447" class="Function">Vec.toList</a> <a id="3000" href="Data.String.html#2904" class="Bound">cells</a><a id="3005" class="Symbol">)</a>
  <a id="3009" href="Data.String.html#3009" class="Function">width</a> <a id="3015" class="Symbol">=</a> <a id="3017" href="Data.List.Extrema.html#1945" class="Function">max</a> <a id="3021" class="Number">0</a> <a id="3023" href="Data.String.html#2964" class="Function">sizes</a>

<a id="3030" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="3086" href="Data.String.html#3086" class="Function">rectangleˡ</a> <a id="3097" class="Symbol">:</a> <a id="3099" class="Symbol">∀</a> <a id="3101" class="Symbol">{</a><a id="3102" href="Data.String.html#3102" class="Bound">n</a><a id="3103" class="Symbol">}</a> <a id="3105" class="Symbol">→</a> <a data-type="Set" id="3107" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="3112" class="Symbol">→</a> <a id="3114" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a data-type="Set" id="3118" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="3125" href="Data.String.html#3102" class="Bound">n</a> <a id="3127" class="Symbol">→</a> <a id="3129" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a data-type="Set" id="3133" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="3140" href="Data.String.html#3102" class="Bound">n</a>
<a id="3142" href="Data.String.html#3086" class="Function">rectangleˡ</a> <a id="3153" href="Data.String.html#3153" class="Bound">c</a> <a id="3155" class="Symbol">=</a> <a id="3157" href="Data.String.html#2799" class="Function">rectangle</a> <a id="3167" class="Symbol">(</a><a id="3168" href="Data.Vec.Base.html#5793" class="Function">Vec.replicate</a> <a id="3182" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3184" href="Data.String.Base.html#3567" class="Function">padLeft</a> <a id="3192" href="Data.String.html#3153" class="Bound">c</a><a id="3193" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="3196" href="Data.String.html#3196" class="Function">rectangleʳ</a> <a id="3207" class="Symbol">:</a> <a id="3209" class="Symbol">∀</a> <a id="3211" class="Symbol">{</a><a id="3212" href="Data.String.html#3212" class="Bound">n</a><a id="3213" class="Symbol">}</a> <a id="3215" class="Symbol">→</a> <a data-type="Set" id="3217" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="3222" class="Symbol">→</a> <a id="3224" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a data-type="Set" id="3228" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="3235" href="Data.String.html#3212" class="Bound">n</a> <a id="3237" class="Symbol">→</a> <a id="3239" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a data-type="Set" id="3243" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="3250" href="Data.String.html#3212" class="Bound">n</a>
<a id="3252" href="Data.String.html#3196" class="Function">rectangleʳ</a> <a id="3263" href="Data.String.html#3263" class="Bound">c</a> <a id="3265" class="Symbol">=</a> <a id="3267" href="Data.String.html#2799" class="Function">rectangle</a> <a id="3277" class="Symbol">(</a><a id="3278" href="Data.Vec.Base.html#5793" class="Function">Vec.replicate</a> <a id="3292" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3294" href="Data.String.Base.html#3686" class="Function">padRight</a> <a id="3303" href="Data.String.html#3263" class="Bound">c</a><a id="3304" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="3307" href="Data.String.html#3307" class="Function">rectangleᶜ</a> <a id="3318" class="Symbol">:</a> <a id="3320" class="Symbol">∀</a> <a id="3322" class="Symbol">{</a><a id="3323" href="Data.String.html#3323" class="Bound">n</a><a id="3324" class="Symbol">}</a> <a id="3326" class="Symbol">→</a> <a data-type="Set" id="3328" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="3333" class="Symbol">→</a> <a data-type="Set" id="3335" href="Agda.Builtin.Char.html#221" class="Postulate">Char</a> <a id="3340" class="Symbol">→</a> <a id="3342" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a data-type="Set" id="3346" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="3353" href="Data.String.html#3323" class="Bound">n</a> <a id="3355" class="Symbol">→</a> <a id="3357" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a data-type="Set" id="3361" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="3368" href="Data.String.html#3323" class="Bound">n</a>
<a id="3370" href="Data.String.html#3307" class="Function">rectangleᶜ</a> <a id="3381" href="Data.String.html#3381" class="Bound">cₗ</a> <a id="3384" href="Data.String.html#3384" class="Bound">cᵣ</a> <a id="3387" class="Symbol">=</a> <a id="3389" href="Data.String.html#2799" class="Function">rectangle</a> <a id="3399" class="Symbol">(</a><a id="3400" href="Data.Vec.Base.html#5793" class="Function">Vec.replicate</a> <a id="3414" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="3416" href="Data.String.Base.html#3807" class="Function">padBoth</a> <a id="3424" href="Data.String.html#3381" class="Bound">cₗ</a> <a id="3427" href="Data.String.html#3384" class="Bound">cᵣ</a><a id="3429" class="Symbol">)</a>
</pre></body></html>